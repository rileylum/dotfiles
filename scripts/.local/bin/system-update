#!/bin/bash

# System update script
# Refreshes mirrorlist, then updates all packages

set -e

echo "=== System Update ==="
echo ""

# Colors
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

info() { echo -e "${GREEN}[INFO]${NC} $1"; }
warn() { echo -e "${YELLOW}[WARN]${NC} $1"; }

# Refresh mirrorlist
info "Sorting mirrors by speed (this may take a moment)..."
sudo reflector \
    --country Australia \
    --age 12 \
    --protocol https \
    --sort rate \
    --latest 10 \
    --save /etc/pacman.d/mirrorlist

info "Mirrorlist updated."
echo ""

# Run update
info "Updating packages..."
yay -Syu

echo ""
info "Update complete!"
